require=function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return o(i||t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({Hamilton:[function(t,e,i){"use strict";function n(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e,i,n,o){var r={};return Object.keys(n).forEach(function(t){r[t]=n[t]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=i.slice().reverse().reduce(function(i,n){return n(t,e,i)||i},r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(t,e,r),r=null),r}cc._RF.push(e,"09604+Tvs5N3ZzbxXq5Dcnq","Hamilton"),Object.defineProperty(i,"__esModule",{value:!0}),i.drawGrayLine=void 0;var l,h,c,u,f,p,d,y,g,v,m,P,b,_,w=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),A=t("./lineAnimate"),k=t("./line"),C=cc._decorator,E=C.ccclass,j=C.property,N=cc.Enum({ADD_P:0,LINE:1}),O=i.drawGrayLine=null;l=j(cc.Node),h=j(cc.Label),c=j(cc.Prefab),u=j(cc.NodePool),f=j(k.line),p=j(A.LineAnim),E((y=function(t){function e(){var t,i,s,a;o(this,e);for(var l=arguments.length,h=Array(l),c=0;c<l;c++)h[c]=arguments[c];return i=s=r(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(h))),n(s,"myCanvasNode",g,s),n(s,"info",v,s),n(s,"pointPrefab",m,s),n(s,"_pointPool",P,s),n(s,"line",b,s),n(s,"lineA",_,s),s.pointsArr=[],s.status=N.ADD_P,s.startIndex=0,s.endIndex=0,s.lineStartPos=null,s.lineEndPos=null,s.handlingP=0,s.footPrint={},a=i,r(s,a)}return s(e,cc.Component),w(e,[{key:"onLoad",value:function(){var t=this.myCanvasNode.getNodeToWorldTransformAR();this.myCavnasPos=cc.p(t.tx,t.ty),this._pointPool=new cc.NodePool,i.drawGrayLine=O=this.drawGrayLine.bind(this),this.hamiltonPath=[],this.cb=this.drawAnimLine.bind(this)}},{key:"lineStartPos_SET_",value:function(t){this.lineStartPos=t;var e=t.x+","+t.y+"\n";this.lineEndPos&&(e+=this.lineEndPos.x+","+this.lineEndPos.y+"\n"),this.info.string=e}},{key:"lineEndPos_SET_",value:function(t){this.lineEndPos=t;var e=void 0;this.lineStartPos&&(e=this.lineStartPos.x+","+this.lineStartPos.y+"\n"),t&&(e+=t.x+","+t.y+"\n"),this.info.string=e}},{key:"addPoint",value:function(){this.status=N.ADD_P}},{key:"linePoint",value:function(){this.status=N.LINE}},{key:"drawGrayLine",value:function(t){switch(this.handlingP){case 0:this.lineStartPos_SET_(this.pointsArr[t]),this.handlingP=1;break;case 1:this.lineEndPos_SET_(this.pointsArr[t]),this.handlingP=2,this.line.drawLine(this.lineStartPos,this.lineEndPos),this.lineStartPos.joints.push(this.lineEndPos),this.lineEndPos.joints.push(this.lineStartPos);break;case 2:this.lineStartPos_SET_(this.pointsArr[t]),this.lineEndPos_SET_(null),this.handlingP=1}}},{key:"myCanvas",value:function(t){if(this.status===N.ADD_P){var e=cc.pSub(t.getLocation(),this.myCavnasPos),i=this._pointPool.get()||cc.instantiate(this.pointPrefab);i.parent=this.myCanvasNode,i.position=e;var n=this.pointsArr.length;i.index=n,e.index=n,e.joints=[],this.pointsArr.push(e)}}},{key:"generate",value:function(){var t,e=this.pointsArr.length,i=this.pointsArr[0];for(t=i.joints[0],this.hamiltonPath.push(i),this.hamiltonPath.push(t),this.footPrint[i.index]=!0,this.footPrint[t.index]=!0;;){var n=this.hamiltonPath.length;if(this.expand(t)||(this.reverse(0,this.hamiltonPath.length-1),cc.log("reverse Path")),i=this.hamiltonPath[0],t=this.hamiltonPath[this.hamiltonPath.length-1],!this.expand(t)){var o=i.joints.includes[t];o||(o=this.findAPathNodeID(i,t)),o&&this.hamiltonPath.length!==e&&this.handleLoop()}if(i=this.hamiltonPath[0],t=this.hamiltonPath[this.hamiltonPath.length-1],n===this.hamiltonPath.length)break}this.drawAnimLine(0)}},{key:"expand",value:function(t){for(var e=0,i=t.joints.length;e<i;e++){var n=t.joints[e];if(!this.footPrint[n.index])return this.hamiltonPath.push(n),this.footPrint[n.index]=!0,cc.log(this.hamiltonPath.slice()),!0}return!1}},{key:"findAPathNodeID",value:function(t,e){cc.log("尝试形成回路");for(var i=1,n=this.hamiltonPath.length;i<n-2;i++)if(this.hamiltonPath[i].joints.includes(e)&&this.hamiltonPath[i+1].joints.includes(t))return this.reverse(i+1,this.hamiltonPath.length-1),cc.log("success"),!0;return!1}},{key:"handleLoop",value:function(){for(var t=1,e=this.hamiltonPath.length;t<e-1;t++)for(var i=0,n=this.hamiltonPath[t].joints.length;i<n;i++){var o=this.hamiltonPath[t].joints[i];if(!this.footPrint[o.index])return cc.log("处理回路",t),this.reverse(0,t-1),this.reverse(t,this.hamiltonPath.length-1),this.hamiltonPath.push(o),void(this.footPrint[o.index]=!0)}}},{key:"reverse",value:function(t,e){for(var i;t<e;)i=this.hamiltonPath[t],this.hamiltonPath[t]=this.hamiltonPath[e],this.hamiltonPath[e]=i,t+=1,e-=1}},{key:"drawAnimLine",value:function(t){var e=this;this.lineA.generateNewNode(this.hamiltonPath[t]),(t+=1)<this.hamiltonPath.length&&setTimeout(function(){e.cb(t)},400)}},{key:"generate1",value:function(){var t=this.pointsArr.length;this.hamiltonPath.push(this.pointsArr[0]),this.footPrint[0]=!0,function e(i,n,o){if(o===t){var r=n[0],s=n[o-1];return!!r.joints.includes(s)}for(var a=0,l=n[o-1].joints.length;a<l;a++){var h=n[o-1].joints[a];if(!i[h.index]){if(i[h.index]=!0,n.push(h),e(i,n,o+1))return!0;i[h.index]=!1,n.pop()}}return!1}(this.footPrint,this.hamiltonPath,1),this.drawAnimLine(0)}}]),e}(),g=a(y.prototype,"myCanvasNode",[l],{enumerable:!0,initializer:function(){return null}}),v=a(y.prototype,"info",[h],{enumerable:!0,initializer:function(){return null}}),m=a(y.prototype,"pointPrefab",[c],{enumerable:!0,initializer:function(){return null}}),P=a(y.prototype,"_pointPool",[u],{enumerable:!0,initializer:function(){return null}}),b=a(y.prototype,"line",[f],{enumerable:!0,initializer:function(){return null}}),_=a(y.prototype,"lineA",[p],{enumerable:!0,initializer:function(){return null}}),d=y));cc._RF.pop()},{"./line":"line","./lineAnimate":"lineAnimate"}],lineAnimate:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}cc._RF.push(e,"60e27zInTRNw50HMealR7fP","lineAnimate"),Object.defineProperty(i,"__esModule",{value:!0});var s,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l={hostBlue:new cc.Color(30,122,193),guestPurp:new cc.Color(137,87,161),newYellow:new cc.Color(255,255,0),lineColor:new cc.Color(0,255,0)},h=cc._decorator,c=h.ccclass;h.property,i.LineAnim=c(s=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,cc.Component),a(e,[{key:"onLoad",value:function(){this.nodesArray=[],this.endNode=null,this.runningNode=null,this.shakingCircleR=50,this.generateNodesCD=.3,this.lineAnimInterval=.3,this.circleAnimInterval=.2,this.circleAnimRatio=-1,this.lineSpeed=0,this.lastLength=0,this.lastDistance=0,this.lastVec=null,this.waveEff=!1,this.teamColor=l.hostBlue,this.time=this.generateNodesCD,this.g=this.node.getComponent(cc.Graphics)}},{key:"clear",value:function(){this.g.clear(),this.nodesArray.splice(0,this.nodesArray.length),this.waveEff=!1,this.endNode=this.runningNode=null,this.shakingCircleR=50,this.circleAnimRatio=-1,this.lineSpeed=0,this.lastDistance=this.lastLength=this.lineSpeed=0,this.lastVec=null}},{key:"generateNewNode",value:function(t){this.teamColor=l.hostBlue;var e=this.nodesArray.length;this.endNode=t,this.waveEff=!0,e?(this.lastVec=this.endNode.sub(this.nodesArray[e-1]),this.lastDistance=this.lastVec.mag(),this.lineSpeed=this.lastDistance/this.lineAnimInterval,this.runningNode=this.nodesArray[e-1].clone()):this.nodesArray.push(this.endNode.clone()),this.circleAnimRatio=-1,this.shakingCircleR=50}},{key:"_random",value:function(t){return(Math.sin(t%1e3*687.3123)+1)/2}},{key:"draw",value:function(){var t=this,e=this.nodesArray.length;this.g.clear(),e&&(this.g.fillColor=this.teamColor,this.g.lineWidth=3,this.nodesArray.forEach(function(e){t.g.circle(e.x,e.y,4),t.g.fill()}));var i=0;if(this.endNode&&(this.g.strokeColor=l.newYellow,this.g.lineWidth=5,this.g.circle(this.endNode.x,this.endNode.y,5),this.g.stroke(),i=1),this.shakingCircleR&&this.waveEff){var n=this.endNode||this.nodesArray[e-1];this.g.strokeColor=new cc.Color(0,0,255,255-5.1*this.shakingCircleR),this.g.lineWidth=3,this.g.circle(n.x,n.y,this.shakingCircleR),this.g.stroke()}if((i+=e)>=2){this.g.strokeColor=l.lineColor,this.g.lineWidth=3,this.g.lineCap=cc.Graphics.LineCap.ROUND,this.g.moveTo(this.nodesArray[0].x,this.nodesArray[0].y);for(var o=1;o<e;o++)this.g.lineTo(this.nodesArray[o].x,this.nodesArray[o].y);this.runningNode&&this.g.lineTo(this.runningNode.x,this.runningNode.y),this.g.stroke()}}},{key:"update",value:function(t){if(this.waveEff){if(this.lastDistance)if(this.lastLength<this.lastDistance){this.lastLength+=this.lineSpeed*t;var e=this.lastVec.mag();e&&this.lastVec.mulSelf(this.lastLength/e),this.runningNode=this.lastVec.add(this.nodesArray[this.nodesArray.length-1])}else this.lastLength=this.lastDistance=this.lineSpeed=0,this.runningNode=null,this.circleAnimRatio=1,this.nodesArray.push(this.endNode.clone()),this.endNode=null;this.circleAnimRatio&&this.waveEff&&(this.shakingCircleR+=this.circleAnimRatio*(50/this.circleAnimInterval)*t,this.shakingCircleR<0&&-1==this.circleAnimRatio&&(this.circleAnimRatio=0,this.shakingCircleR=0),this.shakingCircleR>50&&1==this.circleAnimRatio&&(this.circleAnimRatio=0,this.shakingCircleR=0)),this.draw()}}}]),e}())||s;cc._RF.pop()},{}],line:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}cc._RF.push(e,"08ac5YeLcFBxazF4BIgx9bp","line"),Object.defineProperty(i,"__esModule",{value:!0});var s,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=cc._decorator,h=l.ccclass,c=(l.property,new cc.Color(139,139,139));i.line=h(s=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,cc.Component),a(e,[{key:"onLoad",value:function(){this.g=this.node.getComponent(cc.Graphics)}},{key:"clear",value:function(){this.g.clear()}},{key:"drawLine",value:function(t,e){this.g.strokeColor=c,this.g.lineWidth=3,this.g.moveTo(t.x,t.y),this.g.lineTo(e.x,e.y),this.g.stroke()}}]),e}())||s;cc._RF.pop()},{}],pointEvent:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}cc._RF.push(e,"074fbqcAUFN0ZeIRbET9YQl","pointEvent");var s,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("./Hamilton"),h=cc._decorator,c=h.ccclass;h.property,c(s=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,cc.Component),a(e,[{key:"line",value:function(){(0,l.drawGrayLine)(this.node.index)}}]),e}());cc._RF.pop()},{"./Hamilton":"Hamilton"}]},{},["Hamilton","line","lineAnimate","pointEvent"]);